/* app/globals.css — FULL REPLACEMENT */

/* ========== Tailwind base ========== */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* smooth scrolling with PRM fallback */
html { scroll-behavior: smooth; }
@media (prefers-reduced-motion: reduce){ html { scroll-behavior: auto; } }

/* ========== THEME TOKENS ========== */
:root,[data-theme="dark"]{
  --color-bg:#000000;
  --color-fg:#e7e7ea;
  --color-muted:#a1a1aa;
  --color-accent:#0ea5e9;
  --color-border:rgba(255,255,255,.10);
  --color-card:rgba(255,255,255,.05);
  color-scheme: dark;
}
[data-theme="light"]{
  --color-bg:#f8fafc;
  --color-fg:#0b0b0c;
  --color-muted:#475569;
  --color-accent:#0ea5e9;
  --color-border:rgba(0,0,0,.12);
  --color-card:rgba(0,0,0,.04);
  color-scheme: light;
}

/* ========== BASE ========== */
*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  @apply bg-[var(--color-bg)] text-[var(--color-fg)] antialiased;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
}

/* accessibility */
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{left:1rem;top:1rem;width:auto;height:auto;z-index:60;background:var(--color-bg);border:1px solid var(--color-border);padding:.5rem 1rem;border-radius:.5rem}
:focus-visible{outline:2px solid var(--color-accent);outline-offset:2px}

/* headings */
h1{@apply text-3xl md:text-4xl tracking-tight}
h2{@apply text-xl md:text-2xl tracking-tight}

/* links */
.link-underline{position:relative}
.link-underline::after{
  content:"";position:absolute;left:0;bottom:-2px;height:1px;width:100%;background:currentColor;
  transform:scaleX(0);transform-origin:left;transition:transform 150ms ease;
}
.link-underline:hover::after{transform:scaleX(1)}

/* cards / hover baseline */
.card-hover{transition:transform 150ms cubic-bezier(.2,0,0,1), box-shadow 150ms cubic-bezier(.2,0,0,1);transform:translateY(0) rotate(0)}
.card-hover:hover{box-shadow:0 8px 30px rgba(0,0,0,.20)}
/* if wrapper uses .group, lift the inner card */
.group:hover .card-hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,.20)}

/* borders */
.border-subtle{border-color:var(--color-border)}

/* text clamp */
.line-clamp-2{-webkit-line-clamp:2;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}
.line-clamp-3{-webkit-line-clamp:3;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}

/* ========== HERO (full-bleed gradient + grain) ========== */
.hero-bg{
  position:relative;
  background:
    radial-gradient(1200px 600px at 10% -10%, color-mix(in oklab, var(--color-accent) 35%, transparent), transparent 60%),
    radial-gradient(900px 480px at 90% 0%, color-mix(in oklab, var(--color-fg) 10%, transparent), transparent 60%);
}
.hero-bg::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'>\
  <filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/></filter>\
  <rect width='100%' height='100%' filter='url(%23n)' opacity='0.025'/>\
</svg>");
  background-size:180px 180px;
}

/* OPTIONAL hero fog band (black → fog → white) */
.fog-stage{
  position:absolute; left:0; right:0; bottom:0; height:140px;
  overflow:clip; pointer-events:none; width:100%;
}
.fog-black-cap{
  position:absolute; inset:-30% -10% 40% -10%;
  background: radial-gradient(120% 80% at 50% 0%, #000 65%, rgba(0,0,0,0) 100%);
  filter: blur(20px); opacity:.9;
}
.fog-layer{ position:absolute; inset:-25%; filter: blur(48px) saturate(115%); opacity:.28; mix-blend-mode:screen; will-change:transform,opacity; }
.fog-hue{
  background: conic-gradient(from 340deg, #6be4ff, #a86bff, #ff6bd6, #ff6b6b, #ffd66b, #6bff9e, #6be4ff);
  animation: fogFloatUp 14s ease-in-out infinite, fogSpin 42s linear infinite;
}
.fog-hue2{
  background: conic-gradient(from 160deg, #a86bff, #ff6bd6, #ff6b6b, #ffd66b, #6bff9e, #6be4ff, #a86bff);
  opacity:.22; animation: fogFloatDown 16s ease-in-out infinite, fogSpin 56s linear infinite reverse;
}
.fog-grain{
  position:absolute; inset:-10%;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='240' height='240'>\
  <filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2'/><feColorMatrix type='saturate' values='0'/>\
  <feComponentTransfer><feFuncA type='table' tableValues='0 0.035 0'/></feComponentTransfer></filter>\
  <rect width='100%' height='100%' filter='url(%23n)'/>\
</svg>");
  background-size:240px 240px; mix-blend-mode:soft-light; opacity:.45; animation:fogDrift 24s linear infinite;
}
.fog-to-white{
  position:absolute; left:0; right:0; bottom:0; height:85%;
  background: linear-gradient(to bottom,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.02) 25%,
    rgba(255,255,255,0.08) 45%,
    rgba(255,255,255,0.22) 62%,
    rgba(255,255,255,0.45) 75%,
    #ffffff 100%);
}

/* ========== PROGRESS BARS ========== */
.route-progress{position:fixed;top:0;left:0;height:2px;background:linear-gradient(90deg,#0ea5e9,#7dd3fc);transform-origin:left;z-index:60}
.scroll-progress{position:fixed;top:0;left:0;height:3px;background:rgba(127,127,127,.35);transform-origin:left;z-index:59}
.edge-progress{position:fixed;left:0;top:0;width:2px;background:color-mix(in oklab,var(--color-accent) 70%, transparent);transform-origin:top;z-index:40}

/* ========== MAP (stacking + popup + attribution styling) ========== */
.leaflet-container,.mapboxgl-map{ z-index:0; }

/* glassy popups with location-only look */
.mapboxgl-popup-content{
  background: color-mix(in oklab, var(--color-bg) 70%, transparent);
  color: var(--color-fg);
  border: 1px solid var(--color-border);
  border-radius: 10px;
  backdrop-filter: blur(6px);
  padding: 6px 10px;
}
.mapboxgl-popup-tip{ border-top-color: color-mix(in oklab, var(--color-bg) 70%, transparent) !important; }
.popup-card{ font-size: 12px; }

/* attribution restyle (stays compliant) */
.mapboxgl-ctrl-attrib{
  background: none !important;
  font-size: 11px !important;
  color: var(--color-fg) !important;
  text-transform: uppercase;
  letter-spacing: .05em;
  padding: 2px 6px !important;
  border-radius: 6px;
  backdrop-filter: blur(6px);
  background-color: rgba(0,0,0,.5);
}
.mapboxgl-ctrl-attrib a{ color: var(--color-accent) !important; text-decoration:none !important; }
.mapboxgl-ctrl-attrib a:hover{ text-decoration: underline !important; }

/* ========== MASONRY (magazine layout) ========== */
.masonry{column-gap:1.5rem}
@media (min-width:640px){.masonry{column-count:2}}
@media (min-width:768px){.masonry{column-count:3}}
.masonry-item{break-inside:avoid;margin-bottom:1.5rem}

/* photo hover caption helper */
.caption-bar{
  transform:translateY(12px);
  opacity:0;
  transition:transform 200ms cubic-bezier(.2,0,0,1),opacity 200ms cubic-bezier(.2,0,0,1);
}
.group:hover .caption-bar{ transform:translateY(0); opacity:1; }

/* ========== FOOTER: wind-blown rainbow fog → white ========== */
.windfog{ width:100vw; height:160px; pointer-events:none; overflow:hidden; }
.windfog-svg{ width:100%; height:100%; display:block; }

/* footer base (always white below the fog) */
.footer-white{ background:#fff; color:#0b0b0c; }
.footer-link{ color:#0b0b0c; text-decoration:none; position:relative; }
.footer-link::after{ content:""; position:absolute; left:0; right:0; bottom:-2px; height:1px; background:#0b0b0c; transform:scaleX(0); transform-origin:left; transition:transform 150ms ease; }
.footer-link:hover::after{ transform:scaleX(1); }
.text-footer-dim{ color:rgba(11,11,12,0.6); }

/* ========== MOTION KEYFRAMES ========== */
@keyframes fogSpin{ 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }
@keyframes fogDrift{ 0%{background-position:0 0} 100%{background-position:240px 0} }
@keyframes fogFloatUp{ 0%,100%{ transform: translateY(6px) } 50%{ transform: translateY(-6px) } }
@keyframes fogFloatDown{ 0%,100%{ transform: translateY(-5px) } 50%{ transform: translateY(5px) } }

/* reduced motion: keep look, stop movement */
@media (prefers-reduced-motion:reduce){
  .fog-hue,.fog-hue2,.fog-grain{ animation:none }
  .windfog-svg #stripe{ animation:none !important; }
}

/* ========== UTILITIES ========== */
.shadow-subtle{ box-shadow:0 8px 30px rgba(0,0,0,.20); }
.bg-card-blur{ background-color:color-mix(in oklab, var(--color-bg) 60%, transparent); backdrop-filter:blur(6px); }
